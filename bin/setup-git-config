#!/usr/bin/env bash

# Setup git configuration with architecture-aware paths
ARCH=$(uname -m)

if [ "$ARCH" = "arm64" ]; then
  # Apple Silicon
  KSDIFF_PATH="/opt/homebrew/bin/ksdiff"
else
  # Intel
  KSDIFF_PATH="/usr/local/bin/ksdiff"
fi

# Update git config for sourcetree difftool
git config --global difftool.sourcetree.cmd "$KSDIFF_PATH -w \"\$LOCAL\" \"\$REMOTE\""

# Update git config for sourcetree mergetool
git config --global mergetool.sourcetree.cmd "$KSDIFF_PATH --merge --output \"\$MERGED\" --base \"\$BASE\" -- \"\$LOCAL\" --snapshot \"\$REMOTE\" --snapshot"

echo "Git configuration updated for $ARCH architecture using $KSDIFF_PATH"
